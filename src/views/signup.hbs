<div class="outer">
	<div class="middle">
		<article class="panel panel-auth auth-register">

			<div class="panel-heading panel-header">
				<h3 class="page-header auth-title">Register</h3>
			</div>
			{{#if data.referral}}
				<h4 class="page-header">You have been invited by {{data.referral.firstname}} {{data.referral.lastname}} of {{data.account.name}}</h4>
			{{else}}
				<div class="separator"></div>
			{{/if}}
			<div class="panel-body panel-content">
        {{#if errors }}
          {{> partials/error }}
        {{else}}
				<form method="post" action="{{> partials/href }}{{#if data.invitation_token}}&invitation_token={{data.invitation_token}}{{/if}}" accept-charset="UTF-8" onsubmit="return validate();">

					<div class="auth-box-left">

						<div class="form-group input register-input">
							<label for="control-label">First name</label>
							<input class="form-control" id="register-first-name" type="text" name="firstname" value="{{data.user.firstname}}" />
						</div>

						<div class="form-group input register-input">
							<label for="control-label">Password</label>
							<input title="Password must contain 4 characters at least a number and a letter" class="form-control is-focused" id="register-password" type="password" name="password" value="" pattern="(?=.*\d)(?=.*[a-zA-Z]).{4,}" />
						</div>

					</div>

					<div class="auth-box-right">

						<div class="form-group input register-input">
							<label for="control-label">Last name</label>
							<input class="form-control" id="register-last-name" type="text" name="lastname" value="{{data.user.lastname}}" />
						</div>

						<div class="form-group input register-input">
							<label for="control-label">Email</label>
							<input class="form-control" id="login-email" type="email" name="email" title="Enter a valid email address" name="email"
							{{#if data.referral}} value="{{data.user.email}}" disabled="disabled" {{else}} required pattern="[^@]+@[^@]+\.[a-zA-Z]{2,}" placeholder="Enter a valid email address" {{/if}} />
						</div>

						<div class="form-group input register-input">
							<label for="control-label">Re-enter password</label>
							<input title="Passwords must match" class="form-control is-focused" id="password-again" type="password" name="password-again" value="" pattern="(?=.*\d)(?=.*[a-zA-Z]).{4,}" />
						</div>

					</div>
					<div class="clear-fix"></div>

					<p id="output-errors" ></p>

					<div class="form-actions">
						<input class="btn submit" type="submit" name="submit" value="Submit">
					</div>

				</form>
				{{/if}}
			</div>

		</article>
	</div>
</div>
<script type="text/javascript">
	function validate(evt){
		var password = document.getElementById('register-password');
		var password_again = document.getElementById('password-again');
		var error = document.getElementById('output-errors');

		if ( password.value.trim() == '' ){
			error.innerHTML = "";
			error.innerHTML = "Please choose your password";
			return false;
		}

		if ( password_again.value.trim() == '' ){
			error.innerHTML = "";
			error.innerHTML = "Please re-enter password";
			return false;
		}

		if ( password_again.value.trim() !== password.value ){
			error.innerHTML = "";
			error.innerHTML = "Passwords do not match";
			return false;
		}
	}
</script>
